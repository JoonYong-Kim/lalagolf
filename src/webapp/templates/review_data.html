{% extends 'base.html' %}

{% block title %}Review Parsed Data{% endblock %}

{% block content %}
    <h2 class="my-4">Review Parsed Golf Round Data</h2>
    {% if error %}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            {{ error }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endif %}

    <form action="{{ url_for('review_round') }}" method="post" class="mt-4">
        {% if unparsed_lines %}
            <h4 class="mt-4 text-danger">Unparsed Lines Detected!</h4>
            <p class="text-danger">The following lines could not be parsed. Please review and correct them in the Raw Data Content section above if necessary.</p>
            <div class="mb-3">
                <textarea class="form-control" rows="5" readonly>{{ "\n".join(unparsed_lines) }}</textarea>
            </div>
        {% endif %}

        <h4 class="mt-4">Raw Data Content:</h4>
        <div class="mb-3">
            <textarea class="form-control" id="raw_data_content" name="raw_data_content" rows="10">{{ raw_data_content }}</textarea>
        </div>

        <h4 class="mt-4">Parsed Round Data (JSON):</h4>
        <div class="mb-3">
            <textarea class="form-control" id="parsed_data" name="parsed_data" rows="15">{{ parsed_data | tojson(indent=4) }}</textarea>
        </div>

        <h4 class="mt-4">Scores and Statistics (JSON):</h4>
        <div class="mb-3">
            <textarea class="form-control" id="scores_and_stats" name="scores_and_stats" rows="15">{{ scores_and_stats | tojson(indent=4) }}</textarea>
        </div>

        <button type="submit" name="action" value="save" class="btn btn-success custom-btn">Save to Database</button>
        <button type="submit" name="action" value="reparse" class="btn btn-info custom-btn">Re-parse Data</button>
        <button type="submit" name="action" value="cancel" class="btn btn-danger custom-btn">Cancel</button>
    </form>
{% endblock %}